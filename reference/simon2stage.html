<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simon 2-stage function — simon2stage • PhIIdesign</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Simon 2-stage function — simon2stage" />
<meta property="og:description" content="The primary objective of a phase II clinical trial of a new drug or regimen is to determine whether it has sufficient biological activity
against the disease under study to warrant more extensive development. 
This function calculates the sample size needed in a Simon 2-stage design which is a
two-stage design that is optimal in the sense that the expected sample size is minimized if the
regimen has low activity subject to constraints upon the size of the type 1 and type 2 errors. 
Two-stage designs which minimize the maximum sample size are also determined." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PhIIdesign</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simon 2-stage function</h1>
    
    <div class="hidden name"><code>simon2stage.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The primary objective of a phase II clinical trial of a new drug or regimen is to determine whether it has sufficient biological activity
against the disease under study to warrant more extensive development. <br />
This function calculates the sample size needed in a Simon 2-stage design which is a
two-stage design that is optimal in the sense that the expected sample size is minimized if the
regimen has low activity subject to constraints upon the size of the type 1 and type 2 errors. <br />
Two-stage designs which minimize the maximum sample size are also determined.</p>
    </div>

    <pre class="usage"><span class='fu'>simon2stage</span>(
  <span class='kw'>p0</span>,
  <span class='kw'>pa</span>,
  <span class='kw'>alpha</span>,
  <span class='kw'>beta</span>,
  eps = <span class='fl'>0.005</span>,
  <span class='kw'>N_min</span>,
  <span class='kw'>N_max</span>,
  admissible = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"chull"</span>, <span class='st'>"CHull"</span>),
  method = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"speedup"</span>, <span class='st'>"original"</span>),
  <span class='kw'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>p0</th>
      <td><p>probability of the uninteresting response (null hypothesis \(H0\))</p></td>
    </tr>
    <tr>
      <th>pa</th>
      <td><p>probability of the interesting response (alternative hypothesis Ha)</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>Type I error rate \(P(reject H0|H0)\)</p></td>
    </tr>
    <tr>
      <th>beta</th>
      <td><p>Type II error rate \(P(reject Ha|Ha)\)</p></td>
    </tr>
    <tr>
      <th>eps</th>
      <td><p>tolerance default value = 0.005</p></td>
    </tr>
    <tr>
      <th>N_min</th>
      <td><p>minimum sample size value for grid search</p></td>
    </tr>
    <tr>
      <th>N_max</th>
      <td><p>maximum sample size value for grid search</p></td>
    </tr>
    <tr>
      <th>admissible</th>
      <td><p>character string indicating how to compute admissible designs, either 'chull' or 'CHull', the former uses grDevices::chull, the latter uses multichull::CHull</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>either 'original' or 'speedup' for the original implementation or a more speedier version</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>arguments passed on to plot in case admissible is set to CHull</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>a data.frame with elements</p><ul>
<li><p>n1: total number of patients in stage1</p></li>
<li><p>n2: total number of patients in stage2</p></li>
<li><p>N: total number of patients=n1+n2</p></li>
<li><p>r1: critical value for the first stage</p></li>
<li><p>r2: critical value for the second stage</p></li>
<li><p>eff: (r2 + 1)/N</p></li>
<li><p>90<!-- %CI_low: Result of call to OneArmPhaseTwoStudy::get_CI. Confidence interval according to Koyama T, Chen H. Proper inference from simon’s two-stage designs. Stat Med. 2008; 27:3145–154; --></p></li>
<li><p>90<!-- %CI_high: Result of call to OneArmPhaseTwoStudy::get_CI. Confidence interval according to Koyama T, Chen H. Proper inference from simon’s two-stage designs. Stat Med. 2008; 27:3145–154; --></p></li>
<li><p>EN.p0: expected sample size under H0</p></li>
<li><p>PET.p0: probability of terminating the trial at the end of the first stage under H0</p></li>
<li><p>MIN: column indicating if the design is the minimal design</p></li>
<li><p>OPT: column indicating if the setting is the optimal design</p></li>
<li><p>ADMISS: column indicating if the setting is the admissible design</p></li>
<li><p>alpha: the actual alpha value which is smaller than <code>alpha_param + eps</code></p></li>
<li><p>beta: the actual beta value where which is smaller than <code>beta_param + eps</code></p></li>
<li><p>p0: your provided <code>p0</code> value</p></li>
<li><p>pa: your provided <code>pa</code> value</p></li>
<li><p>alpha_param: your provided <code>alpha</code> value</p></li>
<li><p>beta_param: your provided <code>beta</code> value</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>if x1&lt;=r1 --&gt; stop futility <br />
if (x1+x2)&lt;=r --&gt; futility <br />
if (x1+x2)&gt; s --&gt; efficacy <br /></p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Simon R. Optimal two-stage designs for phase II clinical trials. Control Clin Trials. 1989;10(1):1-10. doi:10.1016/0197-2456(89)90015-9</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>samplesize</span> <span class='op'>&lt;-</span> <span class='fu'>simon2stage</span>(p0 = <span class='fl'>0.1</span>, pa = <span class='fl'>0.3</span>, alpha = <span class='fl'>0.05</span>, beta = <span class='fl'>0.2</span>,
                          eps = <span class='fl'>0.005</span>, N_min = <span class='fl'>0</span>, N_max = <span class='fl'>50</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span>(<span class='kw'>samplesize</span>)</div><div class='input'><span class='co'># \donttest{</span>
<span class='co'>if</span>(<span class='fu'><a href='https://rdrr.io/r/base/library.html'>require</a></span>(<span class='kw'>multichull</span>, quietly = <span class='fl'>TRUE</span>)){
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='kw'>multichull</span>)
<span class='fu'>simon2stage</span>(p0 = <span class='fl'>0.1</span>, pa = <span class='fl'>0.3</span>, alpha = <span class='fl'>0.05</span>, beta = <span class='fl'>0.2</span>,
            eps = <span class='fl'>0.005</span>, N_min = <span class='fl'>0</span>, N_max = <span class='fl'>200</span>, admissible = <span class='st'>"CHull"</span>)
}</div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘igraph’</span></div><div class='output co'>#&gt; <span class='message'>The following objects are masked from ‘package:stats’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    decompose, spectrum</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:base’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    union</span></div><div class='output co'>#&gt; <span class='message'></span>
#&gt; <span class='message'>Attaching package: ‘plotly’</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:ggplot2’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    last_plot</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:igraph’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    groups</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:stats’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    filter</span></div><div class='output co'>#&gt; <span class='message'>The following object is masked from ‘package:graphics’:</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>    layout</span></div><div class='img'><img src='simon2stage-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; [1] "WARNING: Check whether input parameter 'bound' is specified correctly"</div><div class='img'><img src='simon2stage-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># }</span>

<span class='co'># \donttest{</span>
<span class='co'>## Example 1</span>
<span class='kw'>test</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(p0 = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.05</span>, <span class='fl'>0.1</span>, <span class='fl'>0.2</span>, <span class='fl'>0.3</span>, <span class='fl'>0.4</span>, <span class='fl'>0.5</span>, <span class='fl'>0.6</span>, <span class='fl'>0.7</span>),
                   pa = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.05</span>, <span class='fl'>0.1</span>, <span class='fl'>0.2</span>, <span class='fl'>0.3</span>, <span class='fl'>0.4</span>, <span class='fl'>0.5</span>, <span class='fl'>0.6</span>, <span class='fl'>0.7</span>) <span class='op'>+</span> <span class='fl'>0.2</span>)
<span class='kw'>test</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/merge.html'>merge</a></span>(<span class='kw'>test</span>,
              <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(alpha = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.1</span>, <span class='fl'>0.05</span>, <span class='fl'>0.05</span>), beta = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.1</span>, <span class='fl'>0.2</span>, <span class='fl'>0.1</span>)))
<span class='kw'>samplesize</span> <span class='op'>&lt;-</span> <span class='fu'><a href='fleming1stage.html'>fleming1stage</a></span>(p0 = <span class='kw'>test</span><span class='op'>$</span><span class='kw'>p0</span>, pa = <span class='kw'>test</span><span class='op'>$</span><span class='kw'>pa</span>, alpha = <span class='kw'>test</span><span class='op'>$</span><span class='kw'>alpha</span>, beta = <span class='kw'>test</span><span class='op'>$</span><span class='kw'>beta</span>)
<span class='kw'>samplesize</span> <span class='op'>&lt;-</span> <span class='fu'>simon2stage</span>(p0 = <span class='kw'>test</span><span class='op'>$</span><span class='kw'>p0</span>, pa = <span class='kw'>test</span><span class='op'>$</span><span class='kw'>pa</span>, alpha = <span class='kw'>test</span><span class='op'>$</span><span class='kw'>alpha</span>, beta = <span class='kw'>test</span><span class='op'>$</span><span class='kw'>beta</span>,
                          N_min = <span class='fl'>10</span>, N_max = <span class='kw'>samplesize</span><span class='op'>$</span><span class='kw'>n</span> <span class='op'>+</span> <span class='fl'>15</span>)
<span class='kw'>optimal_minimax</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span>(<span class='kw'>samplesize</span>, FUN=<span class='fu'>function</span>(<span class='kw'>x</span>){
  <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span>(<span class='kw'>x</span>, <span class='kw'>OPT</span> <span class='op'>==</span> <span class='st'>"Optimal"</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"r1"</span>,<span class='st'>"n1"</span>,<span class='st'>"r2"</span>,<span class='st'>"N"</span>,<span class='st'>"EN.p0"</span>,<span class='st'>"PET.p0"</span>)),
        <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span>(<span class='kw'>x</span>, <span class='kw'>MIN</span> <span class='op'>==</span> <span class='st'>"Minimax"</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"r1"</span>,<span class='st'>"n1"</span>,<span class='st'>"r2"</span>,<span class='st'>"N"</span>,<span class='st'>"EN.p0"</span>,<span class='st'>"PET.p0"</span>)))
})
<span class='kw'>optimal_minimax</span> <span class='op'>&lt;-</span> <span class='kw'>data.table</span>::<span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html'>rbindlist</a></span>(<span class='kw'>optimal_minimax</span>)

<span class='co'>## Example 2</span>
<span class='kw'>test</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(p0 = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.05</span>, <span class='fl'>0.1</span>, <span class='fl'>0.2</span>, <span class='fl'>0.3</span>, <span class='fl'>0.4</span>, <span class='fl'>0.5</span>, <span class='fl'>0.6</span>, <span class='fl'>0.7</span>),
                   pa = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.05</span>, <span class='fl'>0.1</span>, <span class='fl'>0.2</span>, <span class='fl'>0.3</span>, <span class='fl'>0.4</span>, <span class='fl'>0.5</span>, <span class='fl'>0.6</span>, <span class='fl'>0.7</span>) <span class='op'>+</span> <span class='fl'>0.15</span>)
<span class='kw'>test</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/merge.html'>merge</a></span>(<span class='kw'>test</span>,
              <span class='fu'><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></span>(alpha = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.1</span>, <span class='fl'>0.05</span>, <span class='fl'>0.05</span>), beta = <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.1</span>, <span class='fl'>0.2</span>, <span class='fl'>0.1</span>)))
<span class='kw'>samplesize</span> <span class='op'>&lt;-</span> <span class='fu'><a href='fleming1stage.html'>fleming1stage</a></span>(p0 = <span class='kw'>test</span><span class='op'>$</span><span class='kw'>p0</span>, pa = <span class='kw'>test</span><span class='op'>$</span><span class='kw'>pa</span>, alpha = <span class='kw'>test</span><span class='op'>$</span><span class='kw'>alpha</span>, beta = <span class='kw'>test</span><span class='op'>$</span><span class='kw'>beta</span>)
<span class='kw'>samplesize</span> <span class='op'>&lt;-</span> <span class='fu'>simon2stage</span>(p0 = <span class='kw'>test</span><span class='op'>$</span><span class='kw'>p0</span>, pa = <span class='kw'>test</span><span class='op'>$</span><span class='kw'>pa</span>, alpha = <span class='kw'>test</span><span class='op'>$</span><span class='kw'>alpha</span>, beta = <span class='kw'>test</span><span class='op'>$</span><span class='kw'>beta</span>,
                          N_min = <span class='fl'>25</span>, N_max = <span class='kw'>samplesize</span><span class='op'>$</span><span class='kw'>n</span> <span class='op'>+</span> <span class='fl'>20</span>)
<span class='kw'>optimal_minimax</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span>(<span class='kw'>samplesize</span>, FUN=<span class='fu'>function</span>(<span class='kw'>x</span>){
  <span class='fu'><a href='https://rdrr.io/r/base/cbind.html'>cbind</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span>(<span class='kw'>x</span>, <span class='kw'>OPT</span> <span class='op'>==</span> <span class='st'>"Optimal"</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"r1"</span>,<span class='st'>"n1"</span>,<span class='st'>"r2"</span>,<span class='st'>"N"</span>,<span class='st'>"EN.p0"</span>,<span class='st'>"PET.p0"</span>)),
        <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span>(<span class='kw'>x</span>, <span class='kw'>MIN</span> <span class='op'>==</span> <span class='st'>"Minimax"</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"r1"</span>,<span class='st'>"n1"</span>,<span class='st'>"r2"</span>,<span class='st'>"N"</span>,<span class='st'>"EN.p0"</span>,<span class='st'>"PET.p0"</span>)))
})
<span class='kw'>optimal_minimax</span> <span class='op'>&lt;-</span> <span class='kw'>data.table</span>::<span class='fu'><a href='https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html'>rbindlist</a></span>(<span class='kw'>optimal_minimax</span>)
<span class='co'># }</span></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Koenraad D'Hollander.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



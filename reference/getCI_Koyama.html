<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Koyama confidence interval. — getCI_Koyama • PhIIdesign</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Koyama confidence interval. — getCI_Koyama" />
<meta property="og:description" content="Calculates the two sided 1-2*alpha confidence interval based, by inverting the &quot;rejection probability
function&quot; (or the &quot;p value function&quot;) at every possible value for the null hypothesis between [0,1].
A two-sided (1 − 2*alpha) CI interval includes then all values of binomial proportions for
which the p value for testing H0, lays within the interval [alpha, 1 − alpha]
A stage-wise ordering of the sample space is used:
Let m be the stopping stage and x the total number of responses. A trial outcome (m'; x') is at least as
extreme (against H0) as the observed trial outcome (m; x), if one of the 3 following conditions is met:
(A) m' = m and x'&amp;gt;=x
(B) m' = 1, m = 2 and x'&amp;gt;=a
(C) m' = 2, m = 1 and x &amp;lt;=r1
In the case of Simon’s and Fleming's 2-stage design, stage-wise ordering means that outcomes observed in
the second stage of the trial are more extreme than outcomes observed in the first stage of the trial.
In the case of Fleming's 2-stage design, stage-wise ordering means that rejection of H0
in the first stage is more extreme than rejection in the second stage" />






<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->




  

  

  </head>

  <body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PhIIdesign</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Koyama confidence interval.</h1>
    
    <div class="hidden name"><code>getCI_Koyama.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates the two sided 1-2*alpha confidence interval based, by inverting the "rejection probability
function" (or the "p value function") at every possible value for the null hypothesis between [0,1].
A two-sided (1 − 2*alpha) CI interval includes then all values of binomial proportions for
which the p value for testing H0, lays within the interval [alpha, 1 − alpha]
A stage-wise ordering of the sample space is used:
Let m be the stopping stage and x the total number of responses. A trial outcome (m'; x') is at least as
extreme (against H0) as the observed trial outcome (m; x), if one of the 3 following conditions is met:
(A) m' = m and x'&gt;=x
(B) m' = 1, m = 2 and x'&gt;=a
(C) m' = 2, m = 1 and x &lt;=r1
In the case of Simon’s and Fleming's 2-stage design, stage-wise ordering means that outcomes observed in
the second stage of the trial are more extreme than outcomes observed in the first stage of the trial.
In the case of Fleming's 2-stage design, stage-wise ordering means that rejection of H0
in the first stage is more extreme than rejection in the second stage</p>
    </div>

    <div class="ref-usage sourceCode"><pre class='sourceCode r'><code><span class='fu'>getCI_Koyama</span><span class='op'>(</span><span class='va'>N</span>, <span class='va'>n1</span>, <span class='va'>r1</span>, a <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='va'>k</span>, <span class='va'>alpha</span>, <span class='va'>design</span>, precision <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span></code></pre></div>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>N</th>
      <td><p>overall sample size.</p></td>
    </tr>
    <tr>
      <th>n1</th>
      <td><p>sample size for the first stage.</p></td>
    </tr>
    <tr>
      <th>r1</th>
      <td><p>critical value for futility decision first stage (Simon's or Sargent's 2-stage)</p></td>
    </tr>
    <tr>
      <th>a</th>
      <td><p>critical value for efficacy decision first stage (Fleming's 2-stage)</p></td>
    </tr>
    <tr>
      <th>k</th>
      <td><p>overall observed responses (must be larger than r1).</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>determining the two sided 1-2*alpha confidence interval.</p></td>
    </tr>
    <tr>
      <th>design</th>
      <td><p>3 choices for 2-stage design: "Simon","Sargent" or "Fleming"</p></td>
    </tr>
    <tr>
      <th>precision</th>
      <td><p>gives the precision (in decimal numbers) to which the confidence interval should be calculated (should be less than 10).</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Koyama T and Chen H (2008): Proper inference from Simon's two-stage designs. Statistics in Medicine, 27(16):3145-3154.
    Nhacolo A, Brannath W. Interval and point estimation in adaptive Phase II trials with binary endpoint. Stat Methods Med Res 2019;28:2635-2648</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <div class="ref-examples sourceCode"><pre class='sourceCode r'><code><span class='r-in'><span class='co'>#Calculate a Simon's two-stage design</span></span>
<span class='r-in'><span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'><a href='simon2stage.html'>simon2stage</a></span><span class='op'>(</span>p0 <span class='op'>=</span> <span class='fl'>0.1</span>, pa <span class='op'>=</span> <span class='fl'>0.3</span>, alpha <span class='op'>=</span> <span class='fl'>0.05</span>, beta <span class='op'>=</span> <span class='fl'>0.2</span>,eps <span class='op'>=</span> <span class='fl'>0.005</span>, N_min <span class='op'>=</span> <span class='fl'>1</span>, N_max <span class='op'>=</span> <span class='fl'>50</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>CI</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/mapply.html'>mapply</a></span><span class='op'>(</span>a_ <span class='op'>=</span> <span class='va'>res</span><span class='op'>$</span><span class='va'>N</span>, b_ <span class='op'>=</span> <span class='va'>res</span><span class='op'>$</span><span class='va'>n1</span> , c_ <span class='op'>=</span> <span class='va'>res</span><span class='op'>$</span><span class='va'>r1</span>, d_ <span class='op'>=</span> <span class='va'>res</span><span class='op'>$</span><span class='va'>r2</span> <span class='op'>+</span> <span class='fl'>1</span>, FUN <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>a_</span>, <span class='va'>b_</span>, <span class='va'>c_</span>, <span class='va'>d_</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'>getCI_Koyama</span><span class='op'>(</span>N <span class='op'>=</span> <span class='va'>a_</span>,  n1 <span class='op'>=</span> <span class='va'>b_</span>, r1 <span class='op'>=</span> <span class='va'>c_</span>, k <span class='op'>=</span> <span class='va'>d_</span>, a<span class='op'>=</span><span class='cn'>NULL</span>, alpha <span class='op'>=</span> <span class='fl'>0.05</span>, design<span class='op'>=</span><span class='st'>"Simon"</span>,precision <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'><span class='fu'>getCI_Koyama</span><span class='op'>(</span>N <span class='op'>=</span> <span class='fl'>21</span>,  n1 <span class='op'>=</span> <span class='fl'>14</span>, r1 <span class='op'>=</span> <span class='fl'>1</span>, k <span class='op'>=</span> <span class='fl'>5</span>, a<span class='op'>=</span><span class='cn'>NULL</span>, alpha <span class='op'>=</span> <span class='fl'>0.05</span>, design<span class='op'>=</span><span class='st'>"Simon"</span>,precision <span class='op'>=</span> <span class='fl'>3</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   CI_LL CI_UL</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1   0.1 0.387</span>
</code></pre></div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p><p>Developed by Koenraad D’Hollander.</p></p>
</div>

<div class="pkgdown">
  <p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p></p>
</div>

      </footer>
   </div>

  


  

  </body>
</html>



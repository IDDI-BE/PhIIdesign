% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fleming2stage.R
\name{fleming2stage}
\alias{fleming2stage}
\title{Fleming 2-stage function}
\usage{
fleming2stage(
  p0,
  pa,
  alpha,
  beta,
  eps = 0,
  N_min,
  N_max,
  int = 0,
  int_window = 0.025,
  opt_under = "H0",
  CI_type = "Koyama"
)
}
\arguments{
\item{p0}{probability of the uninteresting response (null hypothesis \eqn{H0})}

\item{pa}{probability of the interesting response (alternative hypothesis Ha)}

\item{alpha}{Type I error rate \eqn{P(reject H0|H0)}}

\item{beta}{Type II error rate \eqn{P(reject Ha|Ha)}}

\item{eps}{tolerance default value = 0.005}

\item{N_min}{minimum sample size value for grid search}

\item{N_max}{maximum sample size value for grid search}

\item{int}{pre-specified interim analysis percentage information}

\item{int_window}{window around interim analysis percentage (e.g. 0.5 +- 0.025). 0.025 is default value}

\item{opt_under}{optimality under "H0" or "Ha"}

\item{CI_type}{"Koyama", see \code{\link{getCI_Koyama}}, or any type for \link[binom]{binom.confint}}
}
\value{
a data.frame with elements
\itemize{
\item n1: total number of patients in stage1
\item n2: total number of patients in stage2
\item N: total number of patients=n1+n2
\item r1: ("r" stands for "rejection") threshold for "rejecting" Ha: if x1<=r1 --> stop for futility at first stage
\item r2: ("r" stands for "rejection") threshold for "rejecting" Ha: if x1+x2<=r --> futility at second stage
\item a: ("a" for "acceptance") threshold for "accepting" Ha= stop for efficacy at first stage
\item eff: (r2 + 1)/N
\item CI_LL: (1-2*alpha) CI lower limit
\item CI_UL: (1-2*alpha) CI upper limit
\item EN.p0: expected sample size under H0
\item PET.p0: probability of terminating the trial for futility at the end of the first stage under H0
\item EN.pa: expected sample size under Ha
\item PET.pa: probability of terminating the trial for efficacy at the end of the first stage under Ha
\item MIN: column indicating if the design is the minimal design
\item OPT: column indicating if the setting is the optimal design
\item ADMISS: column indicating if the setting is the admissible design
\item alpha: the actual alpha value which is smaller than \code{alpha_param + eps}
\item beta: the actual beta value where which is smaller than \code{beta_param + eps}
\item p0: your provided \code{p0} value
\item pa: your provided \code{pa} value
\item alpha_param: your provided \code{alpha} value
\item beta_param: your provided \code{beta} value
}
}
\description{
The primary objective of a phase II clinical trial of a new drug or regimen is to determine whether it has sufficient biological activity
against the disease under study to warrant more extensive development. \cr
This function calculates the sample size needed in a Fleming 2-stage design which is a
two-stage design that is optimal in the sense that the expected sample size is minimized if the
regimen has low activity subject to constraints upon the size of the type 1 and type 2 errors. \cr
Two-stage designs which minimize the maximum sample size are also determined. \cr
This type of design also allows stopping for efficacy
}
\details{
if x1<=r1 --> stop futility at first stage \cr
if r1<x1<a --> proceed to second dtage \cr
if x1>=a --> stop efficacy at first stage \cr
if (x1+x2)<=r2 --> futility at second stage \cr
if (x1+x2)> r2 --> efficacy at second stage \cr
So PET.H0=P_H0(X1<=r1)+P_H0(X1>=a1)
}
\examples{
result_H0 <-fleming2stage(p0 = 0.3, pa = 0.5, alpha = 0.1, beta = 0.1, eps = 0, N_min = 3,
N_max = 50, opt_under="H0")
result_Ha <-fleming2stage(p0 = 0.3, pa = 0.5, alpha = 0.1, beta = 0.1, eps = 0, N_min = 3,
N_max = 50, opt_under="Ha")
}
\references{
Mander AP, Thompson SG. Two-stage designs optimal under the alternative hypothesis for phase II cancer clinical trials.
    Contemporary Clinical Trials 2010;31:572â€“578
    Qin F et al. Optimal, minimax and admissible two-stage design for phase II oncology clinical trials. BMC Medical Research Methodology 2020;20:126
}
